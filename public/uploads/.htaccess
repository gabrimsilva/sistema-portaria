# ğŸš¨ BLOQUEIO TOTAL DE ACESSO DIRETO A DADOS BIOMÃ‰TRICOS ğŸš¨
# Este arquivo .htaccess impede qualquer acesso direto a fotos/arquivos biomÃ©tricos
# conforme exigido pela LGPD para proteÃ§Ã£o de dados sensÃ­veis

# âŒ NEGAR ACESSO A TODOS OS ARQUIVOS NESTE DIRETÃ“RIO
Order deny,allow
Deny from all

# âŒ Bloquear execuÃ§Ã£o de qualquer script
<FilesMatch "\.(php|phtml|pl|py|jsp|asp|sh|cgi|js|html|htm)$">
    Order deny,allow
    Deny from all
</FilesMatch>

# âŒ Bloquear acesso a TODAS as imagens (proteÃ§Ã£o crÃ­tica)
<FilesMatch "\.(jpg|jpeg|png|gif|webp|svg|bmp|tiff|raw|psd|ico)$">
    Order deny,allow
    Deny from all
</FilesMatch>

# âŒ NÃ£o permitir listagem de diretÃ³rio
Options -Indexes -ExecCGI -FollowSymLinks

# âŒ Bloquear tambÃ©m arquivos de configuraÃ§Ã£o
<FilesMatch "\.(htaccess|htpasswd|ini|conf|log|xml|json)$">
    Order deny,allow
    Deny from all
</FilesMatch>

# ğŸ“‹ Mensagens de erro personalizadas
ErrorDocument 403 "ğŸš« ACESSO NEGADO: Dados biomÃ©tricos protegidos pela LGPD. Use o sistema oficial para visualizaÃ§Ã£o segura."
ErrorDocument 404 "âŒ Arquivo nÃ£o encontrado"
ErrorDocument 401 "ğŸ”’ NÃ£o autorizado"

# ğŸ›¡ï¸ Headers de seguranÃ§a mÃ¡xima
<IfModule mod_headers.c>
    Header always set X-Content-Type-Options "nosniff"
    Header always set X-Frame-Options "DENY"
    Header always set X-XSS-Protection "1; mode=block"
    Header always set Referrer-Policy "no-referrer"
    Header always set Cache-Control "no-cache, no-store, must-revalidate"
    Header always set Pragma "no-cache"
    Header always set Expires "0"
    Header always set Content-Security-Policy "default-src 'none'"
</IfModule>

# ğŸ” Bloquear mÃ©todos HTTP nÃ£o necessÃ¡rios
<LimitExcept GET>
    Order deny,allow
    Deny from all
</LimitExcept>

# âš ï¸ AVISO CRÃTICO PARA DESENVOLVEDORES âš ï¸
# 
# Este diretÃ³rio contÃ©m dados biomÃ©tricos sensÃ­veis protegidos pela LGPD:
# 
# âœ… ACESSO CORRETO:
#    - Use o endpoint /secure/biometric/photo?id=X&token=Y
#    - AutenticaÃ§Ã£o obrigatÃ³ria via sessÃ£o
#    - Token de acesso temporÃ¡rio necessÃ¡rio
#    - Logs de auditoria automÃ¡ticos
# 
# âŒ NUNCA PERMITIR:
#    - Acesso direto via URL (ex: /uploads/employees/foto.jpg)
#    - Links pÃºblicos ou compartilhÃ¡veis
#    - Cache de imagens no navegador
#    - Download direto sem autenticaÃ§Ã£o
# 
# ğŸ”§ MIGRAÃ‡ÃƒO NECESSÃRIA:
#    - Execute /secure/biometric/migrate para mover arquivos
#    - Atualize controllers para usar SecureBiometricController
#    - Remova referÃªncias diretas aos arquivos
# 
# ğŸ“‹ CONFORMIDADE LGPD:
#    - Art. 46: SeguranÃ§a adequada para dados sensÃ­veis
#    - Art. 49: Criptografia e controle de acesso
#    - Art. 11: ProteÃ§Ã£o especial para dados biomÃ©tricos